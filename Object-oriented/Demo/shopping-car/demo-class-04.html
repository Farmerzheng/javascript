<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <title>Document</title>
</head>

<body>
  <p>
    <input type="checkbox" name="" id="check">
    <span class="good"></span>
    <span class="minus">-</span>
    <span class="num"></span>
    <span class="plus">+</span>
    单价<span class="price"></span><span>元</span>
  </p>
  <p>总价<span class="totalPrice">0</span>元</p>
  <script>
  var data = { name: "牛奶", num: 3, price: 10 };

  function ShoppingCar(obj) {
    // 构造函数当中的this ---->实例化的对象
    this.name = obj.name;
    // this.num = obj.num;
    // 因为在num属性当中的set和get方法当中需要一个变量存值
    this._num = obj.num;
    this.price = obj.price;
    this._checked = false;
    this.nameDiv = document.querySelector(".good");
    this.plusBtn = document.querySelector(".plus");
    this.minusBtn = document.querySelector(".minus");
    this.numDiv = document.querySelector(".num");
    this.priceDiv = document.querySelector(".price");
    this.checkbox = document.querySelector("#check");
    this.totalPriceDiv = document.querySelector(".totalPrice");

  }
  // prototype?  构造函数的原型对象（父亲）
  // prototype的属性和方法都会被ShoppingCar 继承
  ShoppingCar.prototype = {

    init: function() {
      this.numDiv.innerText = this.num;
      this.nameDiv.innerText = this.name;
      this.priceDiv.innerText = this.price;
      this.bindEvent();
    },
    // plusClickHandler  ----> 不是一个全局函数，是对象的一个方法
    // .bind(this)  ----> 

    // 默认情况this.plusClickHandler函数当中的this指的是plusBtn,
    // 因为要在this.plusClickHandler方法当中用到num属性
    // --->this.num(this指new出来的对象) 

    bindEvent: function() {
      // 初始化对象

      // 原型对象方法当中的this也是指new出来的对象
      this.plusBtn.addEventListener("click", this.plusClickHandler.bind(this))
      this.minusBtn.addEventListener("click", this.minusClickHandler.bind(this));
      this.checkbox.addEventListener("click", this.checkHandler.bind(this));
    },
    plusClickHandler: function() {
      /* num值变化  -----> 
         监听num值变化----->
         num值只要改变就会调用num属性的set方法---->在num属性的set方法当中监听num值得改变---->
         更新页面

         为什么要监听num值得变化？
            因为数据变化要更新页面
      */
      this.num++;
    },
    minusClickHandler: function() {
      if (this.num == 0) return;
      this.num--;
    },
    checkHandler: function() {
      this.checked = this.checkbox.checked;
    },
    render: function() {
      //重新渲染页面
      this.numDiv.innerText = this.num;
      if (this.checked) {
        this.totalPriceDiv.innerText = this.num*this.price;
      } else {
        this.totalPriceDiv.innerText = 0;
      }
    },
    set num(value) {
      this._num = value;
      // 渲染页面
      this.render();
    },
    get num() {
      return this._num;
    },
    set checked(value) {
      this._checked = value;
      this.render();
    },
    get checked() {
      return this._checked;
    }
  }
  var shoppingCar = new ShoppingCar(data);

  shoppingCar.init();
  </script>
</body>

</html>